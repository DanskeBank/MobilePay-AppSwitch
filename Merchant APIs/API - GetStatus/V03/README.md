# GetStatusV03 service #
The service returns the status of the payment of an order and includes information about refunds.

### Input ###
|Parameter|Type|Description|
|:--------|:---|:----------|
|MerchantID|Char(60)|_Mandatory_. This ID is generated by Danske Bank and sent to the merchant.|
|OrderID|Char(50)|_Mandatory._ This is the Order ID, which has originally been sent to the MobilePay AppSwitch SDK (generated by merchant).|
|CustomerID|Char(60)|_Optional_. Identification of customer in MobilePay systems (phone number with prefix, e.g. +45).|
|DateFrom|Char(10)|_Conditional_. A date minimum used when looking up transaction. Default is current date in format 'YYYYMMDD'. Must be specified if requesting status of a transaction from before today's date.|
|DateTo|Char(10)|_Conditional_. A date maximum used when looking up transaction. Default is current date in format 'YYYYMMDD'. Must be specified if requesting status of a transaction from before today's date.|
|ActionCode|Char(1)|_Mandatory_. Action code specifies the type of output. 'B' - Basic output. ReturnCode, ReasonCode, LatestPaymentStatus, OriginalTransactionID, and OriginalAmount will be returned. NumberOfTransactions will be '0' and there will not be any rows in the Transactions array. 'E' - Extended output. The same info as in 'Basic' will be returned, but the Transaction array will contain the original payment as well as any refunds of the original payment, and NumberOfTransaction will return how many rows there are in the Transactions array.|
|Test|Char(1)|_Optional_. Test flag: Y/N. Default is 'N'.|

### Output ###
|Parameter|Type|Description|
|:--------|:---|:----------|
|ReturnCode|Char(2)|See return code table below.|
|ReasonCode|Char(2)|See reason code table below.|
|LatestPaymentStatus|Char(3)|Latest payment status. (See all possible values below)|
|OriginalTransactionID|Char(20)|The transaction ID of the original transaction.|
|OriginalAmount|Decimal|If latest payment status is reserved it is the amount of the reservation. If it is captured it is the captured amount. These amounts can be different for partial captures.|
|NumOfTransactions|Integer|Number of transactions (e.g. rows in Transactions array).|
|Transactions|Array|See fields in array below.|

#### Array of data ####
|Parameter|Type|Description|
|:--------|:---|:----------|
|TimeStamp|Char(23)|ISO8601 (UTC time) YYYY-MM-DDThh:mm:ss.dddZ (Ex. 2015-01-16T10:53:31.601Z).|
|PaymentStatus|Char(3)|Payment status. (See all possible values below)|
|TransactionID|Char(20)|TransactionID.|
|Amount|Decimal|Amount in transaction.|

### Payment status ###
|Value|Description|
|:----|:----------|
|RES|Payment is reserved.|
|CAN|Reservation is cancelled by merchant.|
|CAP|Payment is captured by merchant.|
|REF|Total payment is refunded by merchant.|
|PAR|Payment is partially refunded by merchant.|
|REJ|The reservation, capture, refund or cancellation is rejected (declined).|

### Return and reason codes ###
The tables below describe the values of the fields *ReturnCode* and *ReasonCode* which are stated in the response from the GetStatusV03 service.

#### Return codes ####
|Value|Text|Description|
|:----|:---|:----------|
|00|OK|Service completed without errors.|
|04|Warning|Service completed with validation errors.|
|08|Error|Service completed with errors.|
|24|Severe error|Service completed with errors that must be examined by Danske Bank.|

#### Reason codes ####
- Reason codes 1-19 are releated to input validation errors.
- Reason codes 20-39 are releated to other errors regarding specific input parameters.
- Reason codes 40-97 are releated for other types of errors.
- Reason code 98 is a deadlock or timeout.
- Reason code 99 is related to errors that must be examined by Danske Bank.

|Value|Text|Description|
|:----|:---|:----------|
|00|OK|Completed without errors|
|01|Invalid Order ID|Order ID is not specified or has an invalid value.|
|02|Invalid Merchant ID|Merchant ID is not specified or has an invalid value.|
|03|Invalid Customer ID|Customer ID is not specified or has an invalid value.|
|04|Invalid Test flag |Test flag is not specified or has an invalid value.|
|08|Invalid ActionCode|ActionCode is not specified or has an invalid value.|
|09|Invalid Date|The date specified is invalid or the format is wrong. DateFrom must be less than or equal to DateTo.|
|20|Merchant not found|The specified Merchant ID could not be confirmed as an active Danske Bank customer.|
|21|Order not found|The specified Order ID for an existing order could not be found in the MobilePay backend (within the given time interval if specified).|
|23|Customer not found|The specified Customer ID could not be found in the MobilePay backend.|
|99|Technical error|The call did not succeed due to a technical error in the backend. The technical error must be examined by Danske Bank.|
