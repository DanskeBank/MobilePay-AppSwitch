# RefundV03 service #
The service refunds the payment transaction.

### Input ###
|Parameter|Type|Description|
|:--------|:---|:----------|
|MerchantID|Char(60)|_Mandatory_. This ID is generated by Danske Bank and sent to the merchant.|
|OrderID|Char(50)|_Mandatory_. This is the Order ID, which has originally been sent to the MobilePay AppSwitch SDK (generated by merchant).|
|CustomerID|Char(60)|_Optional_. Identification of customer in MobilePay systems (phone number with prefix, e.g. +45). Used in backend request messages|
|Amount|Decimal|_Conditional_. Amount to refund. If no amount is specified, the transaction will be refunded completely. Partial refund is possible for capture types = 'P' when amount is specified.|
|BulkRef|Char(18)|_Optional_. A reference for bulking payments on the merchants account statement.|
|DateFrom|Char(10)|_Conditional_. A date minimum used when looking up transaction. Default is current date in format 'YYYYMMDD'. Must be specified if refunding a transaction captured before today's date.|
|DateTo|Char(10)|_Conditional_. A date maximum used when looking up transaction. Default is current date in format 'YYYYMMDD'. Must be specified if refunding a transaction captured before today's date.|
|Test|Char(1)|_Optional_. Test flag: Y/N. Default is 'N'. If Test='Y': The service returns OK, but does not refund any payments.|

### Output ###
|Parameter|Type|Description|
|:--------|:---|:----------|
|ReturnCode|Char(2)|See return code table below.|
|ReasonCode|Char(2)|See reason code table below.|
|TransactionID|Char(20)|This is the transaction ID of the new refund payment.|
|OriginalTransactionID|Char(20)|Transaction ID of the original reservation / payment.|
|RemainderAmount|Decimal|This field contains the remainder amount if the refund is a partial refund. E.g. the transaction is 100 DKK. The merchant calls RefundV03 with a partial refund of amount 20 DKK. In this case the RemainderAmount will be 80 DKK.|

### Return and reason codes ###
The tables below describe the values of the fields *ReturnCode* and *ReasonCode* which are stated in the response from the RefundV03 service.

#### Return codes ####
|Value|Text|Description|
|:----|:---|:----------|
|00|OK|Service completed without errors.|
|04|Warning|Service completed with validation errors.|
|08|Error|Service completed with errors.|
|24|Severe error|Service completed with errors that must be examined by Danske Bank.|

#### Reason codes ####
- Reason codes 1-19 are releated to input validation errors.
- Reason codes 20-39 are releated to other errors regarding specific input parameters.
- Reason codes 40-97 are releated for other types of errors.
- Reason code 98 is a deadlock or timeout.
- Reason code 99 is related to errors that must be examined by Danske Bank.

|Value|Text|Description|
|:----|:---|:----------|
|00|OK|Completed without errors|
|01|Invalid Order ID|Order ID is not specified or has an invalid value.|
|02|Invalid Merchant ID|Merchant ID is not specified or has an invalid value.|
|03|Invalid Customer ID|Customer ID is not specified or has an invalid value.|
|04|Invalid Test flag |Test flag is not specified or has an invalid value.|
|05|Invalid Amount|Amount is not specified or has an invalid value.|
|09|Invalid Date|The date specified is invalid or the format is wrong. DateFrom must be less than or equal to DateTo.|
|20|Merchant not found|The specified Merchant ID could not be confirmed as an active Danske Bank customer.|
|21|Order not found|The specified Order ID for an existing order could not be found in the MobilePay backend (within the given time interval if specified).|
|23|Customer not found|The specified Customer ID could not be found in the MobilePay backend.|
|40|Transaction is already refunded|It is not possible to refund if the amount is already refunded.|
|43|Customer ID and Order ID and in input does not match|The Order ID does not exist for the specified Customer ID.|
|44|Call fails for non-technical reasons|The call has failed for a reason which cannot be disclosed. Stating the specific reason may disclose customer sensitive information (e.g. reaching daily MobilePay limit or having credit card revoked).|
|48|Amount not available|It is not possible to refund the payment due to insufficient funds on merchant account.|
|50|Refund not possible|It is not possible to refund the amount, as no bank account is registered on MobilePay user.|
|99|Technical error|The call did not succeed due to a technical error in the backend. The technical error must be examined by Danske Bank.|
